{% extends "base.html" %}
{% load static %}

{% block title %}
    ToDo App
{% endblock title %}

{% block css_files %}
    <link rel="stylesheet" href="{% static "app.css" %}">
{% endblock css_files %}

{% block content %}

<div class="header-bar">
    <div>
        <h1> Hello {{request.user|title}}</h1>
        <h3 style="margin:0">
            You have <i>{{count}}</i> incomplete task{{count|pluralize}}
        </h3>
    </div>

     {% if request.user.is_authenticated %}
        <!-- <a href="{% url "logout" %}">Logout</a>
            generated a logout redirect loop solved with the form below.
             --> 
        <form method="post" action="{% url 'logout' %}">
            {% csrf_token %}
            <button type="submit">logout</button>
        </form>
    {% else %}
        <a href="{% url "login" %}">Login</a>
    {% endif %}

</div>    

    <hr />
    <h1> ToDo List</h1>
    <a href="{% url "task_create" %}">Add task</a>

    <form action="" method="GET">
        <input type="text" name="search_area" placeholder="Search..." value="{{search_input}}">
        <input type="submit" value="search" >
    </form>

    <table>
        <tr>
            <th> Items </th>
            <th></th>
            <th></th>
        </tr>
        {% for task in tasks %}
        <tr>
            <td>
                {{task.title}}
            </td>
            <td>
                <a href="{% url "task_detail" task.id %}">View</a>
            </td>
            <td>
                <a href="{% url "task_update" task.id %}">Edit</a>
            </td>
            <td>
                <a href="{% url "task_delete" task.id %}">Delete</a>
            </td>
        </tr>
        {% empty %}
            <h3> No items in the table.</h3>
         {% endfor %}
    </table>
{% endblock content %}
